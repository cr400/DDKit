<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<!--<form id="login-form" method="post" onsubmit="return checkForm()">-->
    <!--<input type="text" id="username" name="username">-->
    <!--<input type="password" id="password" name="password">-->
    <!--&lt;!&ndash;<input type="hidden" id="md5-password" name="password">&ndash;&gt;-->
    <!--<button type="submit">Submit</button>-->
<!--</form>-->

<!--<script>-->
    <!--function checkForm() {-->
        <!--var form = document.getElementById('test-form');-->

        <!--var pwd = document.getElementById('password');-->
        <!--pwd.value = toMD5(pwd.value);-->

        <!--return true;-->
    <!--}-->
<!--</script>-->


<form id="login-form" method="post" onsubmit="return checkForm()">
    <input type="text" id="username" name="username">
    <input type="password" id="input-password">
    <input type="hidden" id="md5-password" name="password">
    <button type="submit">Submit</button>
</form>

<script>
    function checkForm() {
        var input_pwd = document.getElementById('input-password');
        var md5_pwd = document.getElementById('md5-password');
        //把用户输入的明文变成MD5;
        md5_pwd.value = toMD5(input_pwd);
        //继续下一步:
        return true;
    }
</script>


<script>
    var fileInput = document.getElementById('test-image-file'),
            info = document.getElementById('test-file-info'),
            prview = document.getElementById('test-imge-preview');
    //监听change事件
    fileInput.addEventListener('change',function () {
        // 清除背景图片:
        preview.style.backgroundImage = '';
        //检查文件是否选择:
        if (!fileInput.value) {
            info.innerHTML = '没有选择文件';
            return;
        }
        //获取Fil引用:
        var file = fileInput.files[0];
        //获取File信息:
        info.innerHTML = '文件: ' + file.name + '<br>' +
                         '大小:' + file.size + '<br>' +
                        '修改:' + file.lastModifiedDate;
        if (file.type !== 'image/jepg' && file.type !== 'image/png' && file.type !== 'image/gif') {
            alert('不是游戏的图片文件!');
            return;
        }
        //读取文件:
        var reader = new FileReader();
        reader.onload = function (e) {
            var
                    data = e.target.result;
            preview.style.backgroundImage = 'url(' + data + ')';
        };
        //以DataURL的形式读取文件:
        reader.readAsDataURL(file);

    })
    
</script>

<script>

    function success() {
        var textarea = document.getElementById('test-response-text');
        textarea.value = text;
    }

    function fail(code) {
        var textarea = document.getElementById('test-response-text');
        textarea.value = 'Error code:' + code;
    }


//    var request = new XMLHttpRequest(); // 新建XMLHttpReqeust对象

    var request;
    if (window.XMLHttpRequest) {
        request = new XMLHttpRequest();
    } else  {
        request = new ActiveXObject('microsoft.XMLHTTP');
    }
    
    request.onreadystatechange = function () { //状态发生变化时,函数被回调
        if (request.readyState === 4) { //成功完成
            //判断响应结果:
            if (request.status === 200) {
                //成功,通过responseText拿到响应的文本:
                return success(request.responseText);
            } else  {
                // 失败,根据响应码判断失败原因:
                return fail(request.status);
            }
        } else  {
            // HTTP请求还在继续...
        }

    }

    //发送请求:
    request.open('GET','/api/categories');
    request.send();

    alert('请求已发送,请等待响应...');
</script>

</body>
</html>